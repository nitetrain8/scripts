*+User Requirements+*
See URS3910, URS4374.17

*+FRS2851+* Report Generation [URS3910, URS4374.21]
* *FRS2851.0:* Embedded metadata requirements: [URS3910.7]
** *FRS2851.0.1* Reports generated by batch will include start/and stop information. [URS3910.7] 
*** The first row will have the following text: Batch Name, Created By, Start Time, End Time
*** The second row will have the following information: Batch_Name, Created_By, Start_Time, Start_Time of the next batch from the Batch Table.
** *FRS2851.0.2* Reports generated by time will include start time and stop time. [URS3910.7]
*** If a user elects to generate a report with a time span starting earlier than the selected database, and/or ending later than the selected database, there is currently no business need to correct them and attempt to coerce the start time and end time.
** *FRS2851.0.3* Time stamps for edge cases during generation by batch: [URS3910.7]
### For an active DB with no 'next batch', use the current time as the 'End Time'
### For an archived DB with no 'next batch', use the start time of the next DB as the 'End Time' 
* *FRS2851.1* The getBatches call should return the list of batches in the active database, sorted in reverse chronological order. [URS4370.6.2, URS3910.1]
* *FRS2851.2* Files for reports generated from either the Web UI and the LabVIEW UI should be located in the C:\Reports folder [URS3910.8]
* *FRS2851.3* Reports layout
!Report_Generation.png!
*Image 1*: Reports Menu Mockup

!Report_Generation_Numbered.png!
*Image 2*: Numbered Reports Menu Mockup

* *FRS2851.4* Appearance [URS4374.21]
## Item 1 - a listbox labelled Databases
### The list itself is a control, where 1 item is selectable
### The items in the list are to be indicators, not controls
### The list is to have 2 columns:
#### The first column is to be labeled "Date/Time Start"
#### The second column is to be labeled "Date/Time Stop"
## Item 2 - a listbox labeled Batches
### The list itself is a control, where 1 item is selectable
### The items in the list are to be indicators, not controls
### The list is to have 3 columns:
#### The first column is to be labeled "Batch Name"
#### The second column is to be labeled "Date/Time Start"
#### The third column is to be labeled "Date/Time Stop"
## Item 3 - a radio control button labeled Report Type
## Item 4 - a radio control button labeled Filter By
## Item 5&6 - Start Time and End Time selectors
### These will be timestamp controls
### The first will be labeled "Start Time"
### The second will be labeled "End Time"
### Both will be in the following format
#### First line: hh:mm:ss PM (instead of 24-hours, show AM or PM)
#### Second line: MM/DD/YYYY
### They will have a "Time/date browse button" tied to each, as displayed in the mockup
## Item 7 - a Boolean button labeled Generate
## Item 8 - a Boolean button labeled Go to File
## Item 9 - a string indicator labeled Status
## Item 10 - a string indicator labeled File 
* *FRS2851.5*: Item 1 - Databases list Functionality [URS4374.21.1]
## This list is to have 1 entry for each database in the Database folder.  Note that if a database is deleted from that folder, it should no longer appear in the list.
## The first column is to show the date and timestamp of when the database was started
## The second column is to show the date and timestamp of when the database was ended.  For the active database, since it still has not ended, show "--" in the second column.
## The list is to be sorted in reverse chronological order, with the active database on top, and the oldest databases on the bottom.
## This list is to be refreshed under the following conditions:
### When the layout is navigated to
### When the layout is active, and a database is archived and a new one is made active.  When this happens, the selected database must shift down by 1, so the same database is selected. 
## Selecting items
### Items in the list can be selected by clicking the item
### Only 1 item may be selected at a time
### 1 item must be selected at all times
### When an item is selected, it will be highlighted blue and its text will be black
### When the layout is first navigated to, the top item (i.e. the active database) will be selected.
### When a selection is made, it will trigger a refresh of item 2 (see below)
## If the list is longer than the display, users will be able to scroll up or down to see all the items.
## Users cannot change the text of the items in the list.
* *FRS2851.6*: Item 2 - Batches list Functionality [URS4374.21.1]
## This list is to have 1 entry for each batch in the selected database in the Databases list (item 2)
## The first column is to show the name of the batch
## The second column is to show the date and timestamp of when the batch was started
## The third column is to show the date and timestamp of when the batch was ended.
### For the active database's current batch, since it has not ended, show "--" in the second column.
### For an archived database, if the last batch was not actually ended in that database, show the end timestamp of the database itself
## The list is to be sorted in reverse chronological order, with the newest batch on top, and the oldest batch on the bottom.
## The list is to be refreshed under the following conditions:
### When the user first navigates to the layout, it must show the list of batches in the active database
### When the user selects a different database in the Databases list
### When the Databases list is refreshed (see item 2 above)
## Selecting items
### Items in the list can be selected by clicking the item
### Only 1 item may be selected at a time
### 1 item must be selected at all times
### When an item is selected, and the list is not grayed out, it will be highlighted blue and its text will be white
### When an item is selected, and the list is grayed out, it will be highlighted gray and its text will be white
### When the layout is first navigated to, the top item (i.e. the newest batch in the selected database) will be selected.
### When a different database is selected in item 2, the top item (i.e. the newest batch in the selected database) will be selected.
## When this item is grayed out, users will not be able to modify it.
* *FRS2851.7*: Item 3 - Report Type selector Functionality [URS4374.21.1]
## The options for this selector are Process Data, User Events, Errors, Alarms, and Recipe Steps
## When the layout is navigated to, Process Data will be selected
## Only 1 item can be selected at any time
## 1 item must be selected at all times
* *FRS2851.8*: Item 4 - Filter By selector Functionality [URS4374.21.1]
## The options for this selector are Batch, and Time
## When the layout is navigated to, Batch will be selected
## Only 1 item can be selected at any time
## 1 item must be selected at all times
## When the 'Batch' item is selected, item 2 is not grayed out, and item 5&6 are grayed out. 
## When the 'Time' item is selected, item 2 is grayed out, and item 6 is not.
* *FRS2851.9*: Item 5&6 - Start Time and End Time selectors functionality [URS4374.21.1]
## When this item is grayed out, users will not be able to modify it.
## When the layout is navigated to, the Start and End Time will be blank. 
* *FRS2851.10*: Item 7 - Generate button Functionality [URS4374.21.1]
## When this button is clicked, a report is generated with the selected parameters.
## While the report is being generated, the 'Status' indicator (item 9) will be updated
## After the report has been generated, its file name will be displayed in item 10
* *FRS2851.11*: Item 8 - Go to file button functionality [URS4374.21.1]
## This will only be visible and clickable if the File Name indicator (item 10) is populated with a report name (a string of digits with .csv type).  Otherwise, it is invisible. 
## When clicked, it will open the File Management VI, and highlight the latest file in the Reports folder
* *FRS2851.12*: Item 9 - Status indicator [URS4374.21.1]
## It will only be visible while a report is being generated.  Otherwise it will be hidden.
* *FRS2851.13*: Item 10 - File Name indicator functionality [URS4374.21.1]
## When the layout is navigated to, this will not be visible.
## When a report is successfully generated in the layout, this will be visible.
## When visible, it will show the file name for the latest report successfully generated from the layout.
* *FRS2851.14*: If an error occurs during report generation, display the error dialog. [URS4374.21.1, URS4374.4]

*+Release Notes+*
* The Report Generation menu in the Desktop UI has been updated, and now uses buttons rather than dropdown menus to select options. 
* A Go To File button now automatically switches tabs and selects the most recently generated report in the File Browser tab of the Desktop UI. 